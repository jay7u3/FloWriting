<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flow Writing</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
      height: 100vh;
      margin: 0;
      background-color: #e0e0e0;
      font-family: Arial, sans-serif;
    }
    .controls {
      width: 80%;
      display: flex;
      justify-content: flex-end;
      gap: 1rem;
      padding: 1rem;
    }
    button, select {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      padding: 10px 20px;
      font-size: 1rem;
      border: 2px solid #aaa;
      border-radius: 8px;
      background-color: transparent;
      color: #555;
      cursor: pointer;
      background-image: none;
    }
    select {
      background: transparent;
    }
    button:hover, select:hover {
      border-color: #555;
      color: #000;
    }
    textarea {
      width: 80%;
      height: 60vh;
      font-size: 1.2rem;
      padding: 1rem;
      background-color: #e0e0e0;
      border: none;
      border-radius: 0;
      resize: none;
      outline: none;
      transition: opacity 4s ease;
      spellcheck: false;
      autocorrect: off;
      autocomplete: off;
      autocapitalize: off;
      -webkit-text-security: none;
    }
    .notification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #444;
      color: white;
      padding: 10px 16px;
      border-radius: 8px;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s ease;
      font-size: 0.95rem;
    }
    .notification.show {
      opacity: 1;
      pointer-events: auto;
    }
  </style>
</head>
<body>

  <div class="controls">
    <button onclick="generatePrompt()" title="G√©n√©rer une id√©e">ü™Ñ</button>
    <select id="durationSelector", title="Dur√©e de la session d'√©criture">
      <option value="60000">1 minute</option>
      <option value="300000">5 minutes</option>
      <option value="900000">15 minutes</option>
      <option value="0">Infini</option>
    </select>
    <button onclick="copyText()" title="Copier">üìã</button>
  </div>

  <textarea id="writer" placeholder="Commencez √† √©crire..." spellcheck="false" autocorrect="off" autocomplete="off" autocapitalize="off"></textarea>

  <div id="notification" class="notification"></div>

  <script>
    let fadeTimeout;
    let clearTimeoutId;
    let sessionTimerId;
    const delayBeforeFade = 3000;
    const fadeDuration = 4000;
    const textarea = document.getElementById('writer');
    const durationSelector = document.getElementById('durationSelector');
    const notification = document.getElementById('notification');
    let sessionStarted = false;

    prompts = [
    "Longtemps, je me suis couch√© de bonne heure",
    "Il √©tait une fois, dans un pays lointain",
    "La mer brillait au loin, immobile et vaste",
    "Personne ne savait comment elle avait disparu",
    "Tout avait commenc√© un matin d‚Äôautomne",
    "Je descendis dans la rue, le c≈ìur battant",
    "Il faisait chaud ce jour-l√†, et tout semblait fig√©",
    "Rien ne laissait pr√©sager ce qui allait suivre",
    "Quand je suis sorti, la ville √©tait d√©serte",
    "La pluie tombait en silence sur les toits gris",
    "C‚Äôest √† ce moment-l√† que je l‚Äôai entendu",
    "Il posa sa main sur l‚Äô√©paule du vieil homme",
    "Tout √©tait calme, trop calme",
    "Elle tenait dans sa main une lettre froiss√©e",
    "Le train partit dans un grondement sourd",
    "Une ombre passa devant la fen√™tre",
    "La pi√®ce sentait encore la fum√©e",
    "C‚Äôest l√† que tout a bascul√©",
    "Un cri per√ßa la nuit",
    "Je n‚Äôavais jamais rien vu d‚Äôaussi √©trange",
    "Le livre √©tait pos√© l√†, comme s‚Äôil attendait",
    "Il marchait depuis des heures sans savoir o√π aller",
    "Ce matin-l√†, elle ne se doutait de rien",
    "Un frisson me traversa quand j‚Äôouvris la porte",
    "Le regard de l‚Äôenfant √©tait fixe, presque absent",
    "Il ne restait que des cendres",
    "Je me rappelle encore le go√ªt de ce silence",
    "Sous la lumi√®re p√¢le, elle semblait irr√©elle",
    "Il referma doucement la bo√Æte en bois",
    "La poussi√®re flottait dans l‚Äôair du grenier","Je suis n√© par une nuit d'orage",
    "Il faisait encore nuit lorsque je quittai la maison",
    "Les √©toiles brillaient, indiff√©rentes",
    "Il attendait depuis trois jours",
    "Rien ne semblait r√©el, pas m√™me",
    "Au sommet de la colline, elle aper√ßut",
    "Une voix int√©rieure lui murmurait de",
    "Le sable chaud crissait sous ses pas",
    "Elle referma le journal, troubl√©e par",
    "Il ne reconnaissait plus sa propre voix",
    "Quelque chose le suivait depuis le matin",
    "Son souffle formait de petits nuages blancs",
    "Il leva les yeux et vit",
    "Il n'y avait plus personne dans la maison",
    "Elle √©crivit son nom pour la derni√®re fois",
    "La temp√™te approchait, in√©vitable",
    "Il ouvrit les yeux sur un plafond inconnu",
    "Les horloges s'√©taient toutes arr√™t√©es",
    "Personne ne parlait plus du vieil homme",
    "Il tenait dans ses mains le dernier souvenir",
    "L‚Äôarbre penchait dangereusement vers la fen√™tre",
    "Un rire √©clata au loin, inattendu",
    "Les journaux du matin parlaient encore de",
    "Ses pas r√©sonnaient dans la cage d‚Äôescalier vide",
    "La f√™te battait son plein quand",
    "Un sifflement aigu fendit l‚Äôair",
    "Il vit le reflet avant de voir la silhouette",
    "Elle posa la plume, √† court d‚Äôencre et de mots",
    "Un enfant chantait dans la rue d√©serte",
    "Chaque soir, √† la m√™me heure, il venait s‚Äôasseoir",
    "Il neigeait encore ce matin-l√†",
    "Il tendit la main, mais ne rencontra que du vide",
    "La cl√© √©tait encore sur la serrure",
    "Elle fit glisser le rideau d‚Äôun geste lent",
    "Une odeur de soufre emplissait la pi√®ce",
    "Il manquait une page dans le vieux carnet",
    "L‚Äôenveloppe √©tait cachet√©e d‚Äôun √©trange symbole",
    "Le chien grattait la porte depuis l‚Äôaube",
    "La trace menait droit vers la rivi√®re",
    "Quelqu‚Äôun frappait √† la fen√™tre depuis des heures"  
];

    function showNotification(message) {
      notification.textContent = message;
      notification.classList.add('show');
      setTimeout(() => notification.classList.remove('show'), 3000);
    }

    function startFade() {
      textarea.style.transition = `opacity ${fadeDuration}ms ease`;
      textarea.style.opacity = '0';
      clearTimeoutId = setTimeout(() => {
        textarea.value = '';
        textarea.style.opacity = '1';
        sessionStarted = false;
      }, fadeDuration);
    }

    function resetTimer() {
      clearTimeout(fadeTimeout);
      clearTimeout(clearTimeoutId);
      textarea.style.opacity = '1';
      fadeTimeout = setTimeout(startFade, delayBeforeFade);
    }

    function startSessionTimer() {
      clearTimeout(sessionTimerId);
      const selectedDuration = parseInt(durationSelector.value);
      if (selectedDuration > 0) {
        sessionTimerId = setTimeout(() => {
          textarea.removeEventListener('input', inputHandler);
          clearTimeout(fadeTimeout);
          clearTimeout(clearTimeoutId);
          textarea.style.opacity = '1';
          showNotification('‚è±Ô∏è Session termin√©e !');
        }, selectedDuration);
      }
    }

    function inputHandler() {
      if (!sessionStarted) {
        sessionStarted = true;
        startSessionTimer();
      }
      resetTimer();
    }

    function copyText() {
      navigator.clipboard.writeText(textarea.value)
        .then(() => showNotification('üìã Texte copi√© !'))
        .catch(() => showNotification('‚ùå Erreur lors de la copie.'));
    }

    function generatePrompt() {
      const randomPrompt = prompts[Math.floor(Math.random() * prompts.length)];
      textarea.value = randomPrompt + " ";
      textarea.focus();
    }

    textarea.addEventListener('input', inputHandler);
  </script>

</body>
</html>
